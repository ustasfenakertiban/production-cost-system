# üìò –ü–æ–¥—Ä–æ–±–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ –∫–æ–¥—É —Å–∏–º—É–ª—è—Ü–∏–∏

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞](#–æ—Å–Ω–æ–≤–Ω–∞—è-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ñ–∞–π–ª–∞)
2. [–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã](#—Ç–∏–ø—ã-–¥–∞–Ω–Ω—ã—Ö-–∏-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã)
3. [–§—É–Ω–∫—Ü–∏—è applyVariance](#—Ñ—É–Ω–∫—Ü–∏—è-applyvariance)
4. [–§—É–Ω–∫—Ü–∏—è validateOrder](#—Ñ—É–Ω–∫—Ü–∏—è-validateorder)
5. [–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è simulateOrder](#–≥–ª–∞–≤–Ω–∞—è-—Ñ—É–Ω–∫—Ü–∏—è-simulateorder)
6. [–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏](#–≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ-—Ñ—É–Ω–∫—Ü–∏–∏)

---

## –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞

–§–∞–π–ª `simulation-engine.ts` —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å—é –ª–æ–≥–∏–∫—É —Å–∏–º—É–ª—è—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤.

**–ü—É—Ç—å –∫ —Ñ–∞–π–ª—É:** `/home/ubuntu/production_cost_system/app/lib/simulation-engine.ts`

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

```
‚îú‚îÄ‚îÄ –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (VarianceMode, ProductivityAlgorithm, etc.)
‚îú‚îÄ‚îÄ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (SimulationParams, Operation, Chain, Order, etc.)
‚îú‚îÄ‚îÄ applyVariance() - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º
‚îú‚îÄ‚îÄ validateOrder() - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–∞
‚îú‚îÄ‚îÄ simulateOrder() - –≥–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–∏–º—É–ª—è—Ü–∏–∏
‚îî‚îÄ‚îÄ –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
    ‚îú‚îÄ‚îÄ releaseResources() - –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
    ‚îú‚îÄ‚îÄ processActiveOperations() - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
    ‚îú‚îÄ‚îÄ tryStartNewOperations() - –ø–æ–ø—ã—Ç–∫–∞ –∑–∞–ø—É—Å–∫–∞ –Ω–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
    ‚îî‚îÄ‚îÄ tryStartChainOperation() - –ø–æ–ø—ã—Ç–∫–∞ –∑–∞–ø—É—Å–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ —Ü–µ–ø–æ—á–∫–µ
```

---

## –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

### VarianceMode

–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–µ–∂–∏–º –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–∏–º—É–ª—è—Ü–∏–∏:

```typescript
export type VarianceMode = 
  | "MAX"                          // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–ª—É—á—à–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π)
  | "MIN"                          // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (—Ö—É–¥—à–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π)
  | "NONE"                         // –ë–µ–∑ –≤–∞—Ä–∏–∞—Ü–∏–π
  | "RANDOM_POSITIVE"              // –°–ª—É—á–∞–π–Ω—ã–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –≤–∞—Ä–∏–∞—Ü–∏–∏ (0 –¥–æ +—Ä–∞–∑–±—Ä–æ—Å)
  | "RANDOM_FULL"                  // –°–ª—É—á–∞–π–Ω—ã–µ –≤–∞—Ä–∏–∞—Ü–∏–∏ –≤ –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã (-—Ä–∞–∑–±—Ä–æ—Å –¥–æ +—Ä–∞–∑–±—Ä–æ—Å)
  | "MIN_PRODUCTIVITY_MAX_COSTS"   // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å + –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã
  | "RANDOM_ASYMMETRIC";           // –ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–µ –≤–∞—Ä–∏–∞—Ü–∏–∏ (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 0 –¥–æ -—Ä–∞–∑–±—Ä–æ—Å, —Ä–∞—Å—Ö–æ–¥—ã: 0 –¥–æ +—Ä–∞–∑–±—Ä–æ—Å)
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- `MAX` - –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π (–≤—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –Ω–∏–∑–∫–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã)
- `MIN` - –ü–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π (–Ω–∏–∑–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –≤—ã—Å–æ–∫–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã)
- `NONE` - –ù–æ–º–∏–Ω–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –±–µ–∑ —É—á–µ—Ç–∞ –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏
- `MIN_PRODUCTIVITY_MAX_COSTS` - –•—É–¥—à–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π (–Ω–∏–∑–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ò –≤—ã—Å–æ–∫–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ)

### ProductivityAlgorithm

–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:

```typescript
export type ProductivityAlgorithm = "BOTTLENECK" | "NOMINAL";
```

**–†–∞–∑–ª–∏—á–∏—è:**

1. **BOTTLENECK (–ë—É—Ç—ã–ª–æ—á–Ω–æ–µ –≥–æ—Ä–ª—ã—à–∫–æ)**
   - –ò—Ç–æ–≥–æ–≤–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å = MIN(–Ω–æ–º–∏–Ω–∞–ª—å–Ω–∞—è, –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ, —Ä–∞–±–æ—Ç–Ω–∏–∫–∏)
   - –°–∞–º—ã–π –º–µ–¥–ª–µ–Ω–Ω—ã–π —Ä–µ—Å—É—Ä—Å –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤—Å—é –æ–ø–µ—Ä–∞—Ü–∏—é
   - –ë–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥

2. **NOMINAL (–ü–æ –Ω–æ–º–∏–Ω–∞–ª—É)**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–æ–º–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏
   - –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –∏ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤
   - –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Ä–∞—Å—á–µ—Ç

---

## –§—É–Ω–∫—Ü–∏—è applyVariance

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ü—Ä–∏–º–µ–Ω—è–µ—Ç –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –∫ –±–∞–∑–æ–≤–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞.

### –°–∏–≥–Ω–∞—Ç—É—Ä–∞

```typescript
export function applyVariance(
  baseValue: number,          // –ë–∞–∑–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 100 —à—Ç/—á–∞—Å)
  variance: number | null,    // –ü—Ä–æ—Ü–µ–Ω—Ç —Ä–∞–∑–±—Ä–æ—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10 = ¬±10%)
  mode: VarianceMode,         // –†–µ–∂–∏–º –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏
  isProductivity: boolean = true  // true = –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, false = —Ä–∞—Å—Ö–æ–¥—ã
): number
```

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

```typescript
// 1. –ï—Å–ª–∏ variance = null, undefined –∏–ª–∏ 0, –∏–ª–∏ mode = "NONE"
//    ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ–º baseValue –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

// 2. –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç –≤ –¥–µ—Å—è—Ç–∏—á–Ω—É—é –¥—Ä–æ–±—å
const varianceDecimal = variance / 100;  // 10% ‚Üí 0.1

// 3. –ü—Ä–∏–º–µ–Ω—è–µ–º –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞:

switch (mode) {
  case "MAX":
    return baseValue * (1 + varianceDecimal);
    // –ü—Ä–∏–º–µ—Ä: 100 * (1 + 0.1) = 110

  case "MIN":
    return baseValue * (1 - varianceDecimal);
    // –ü—Ä–∏–º–µ—Ä: 100 * (1 - 0.1) = 90

  case "RANDOM_POSITIVE":
    return baseValue * (1 + Math.random() * varianceDecimal);
    // –ü—Ä–∏–º–µ—Ä: 100 * (1 + random(0...0.1)) = 100...110

  case "RANDOM_FULL":
    return baseValue * (1 + (Math.random() * 2 - 1) * varianceDecimal);
    // –ü—Ä–∏–º–µ—Ä: 100 * (1 + random(-0.1...+0.1)) = 90...110

  case "MIN_PRODUCTIVITY_MAX_COSTS":
    if (isProductivity) {
      return baseValue * (1 - varianceDecimal);  // –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –£–ú–ï–ù–¨–®–ê–ï–¢–°–Ø
    } else {
      return baseValue * (1 + varianceDecimal);  // –†–∞—Å—Ö–æ–¥—ã –£–í–ï–õ–ò–ß–ò–í–ê–Æ–¢–°–Ø
    }

  case "RANDOM_ASYMMETRIC":
    if (isProductivity) {
      return baseValue * (1 - Math.random() * varianceDecimal);  // 0 –¥–æ -—Ä–∞–∑–±—Ä–æ—Å
    } else {
      return baseValue * (1 + Math.random() * varianceDecimal);  // 0 –¥–æ +—Ä–∞–∑–±—Ä–æ—Å
    }
}
```

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
// –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å —Ä–∞–∑–±—Ä–æ—Å–æ–º ¬±10%
applyVariance(100, 10, "MAX", true);      // ‚Üí 110 —à—Ç/—á–∞—Å
applyVariance(100, 10, "MIN", true);      // ‚Üí 90 —à—Ç/—á–∞—Å
applyVariance(100, 10, "NONE", true);     // ‚Üí 100 —à—Ç/—á–∞—Å (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

// –°—Ç–æ–∏–º–æ—Å—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª–∞ —Å —Ä–∞–∑–±—Ä–æ—Å–æ–º ¬±5%
applyVariance(50, 5, "MAX", false);       // ‚Üí 52.5 —Ä—É–± (—Ä–∞—Å—Ö–æ–¥—ã —Ä–∞—Å—Ç—É—Ç)
applyVariance(50, 5, "MIN", false);       // ‚Üí 47.5 —Ä—É–± (—Ä–∞—Å—Ö–æ–¥—ã –ø–∞–¥–∞—é—Ç)

// –†–µ–∂–∏–º MIN_PRODUCTIVITY_MAX_COSTS (—Ö—É–¥—à–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π)
applyVariance(100, 10, "MIN_PRODUCTIVITY_MAX_COSTS", true);   // ‚Üí 90 (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∞–¥–∞–µ—Ç)
applyVariance(50, 10, "MIN_PRODUCTIVITY_MAX_COSTS", false);   // ‚Üí 55 (—Ä–∞—Å—Ö–æ–¥—ã —Ä–∞—Å—Ç—É—Ç)
```

---

## –§—É–Ω–∫—Ü–∏—è validateOrder

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —É –∑–∞–∫–∞–∑–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Å–∏–º—É–ª—è—Ü–∏–∏.

### –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç

```typescript
{
  valid: boolean;            // true, –µ—Å–ª–∏ –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
  missingParams: string[];   // –°–ø–∏—Å–æ–∫ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ü–µ–ø–æ—á–µ–∫

#### –î–ª—è ONE_TIME (—Ä–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π):
- ‚úÖ –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –ò–õ–ò –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Ä–æ–ª–µ–π
- ‚ö†Ô∏è –ï—Å–ª–∏ –æ–±–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç ‚Üí –æ—à–∏–±–∫–∞

#### –î–ª—è PER_UNIT (–ø–æ—Ç–æ—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π):
1. ‚úÖ –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–ª–∏–Ω–∞ —Ä–∞–±–æ—á–µ–≥–æ —Ü–∏–∫–ª–∞ (cycleHours > 0)
2. ‚úÖ –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
   - –ù–æ–º–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ (estimatedProductivityPerHour), –ò–õ–ò
   - –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (piecesPerHour), –ò–õ–ò
   - –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–æ–ª–µ–π (piecesPerHour)

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –æ—à–∏–±–æ–∫

```
–¢–æ–≤–∞—Ä1 ‚Üí –ü—Ä–æ—Ü–µ—Å—Å1 ‚Üí –¶–µ–ø–æ—á–∫–∞1 ‚Üí –û–ø–µ—Ä–∞—Ü–∏—è1: –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –¥–ª–∏–Ω–∞ —Ä–∞–±–æ—á–µ–≥–æ —Ü–∏–∫–ª–∞
–¢–æ–≤–∞—Ä1 ‚Üí –ü—Ä–æ—Ü–µ—Å—Å1 ‚Üí –¶–µ–ø–æ—á–∫–∞1 ‚Üí –û–ø–µ—Ä–∞—Ü–∏—è2: –¥–ª—è —Ä–∞–∑–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ —É–∫–∞–∂–∏—Ç–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –∏–ª–∏ —Ä–æ–ª–µ–π
```

---

## –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è simulateOrder

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–í—ã–ø–æ–ª–Ω—è–µ—Ç —Å–∏–º—É–ª—è—Ü–∏—é –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞ –æ—Ç –Ω–∞—á–∞–ª–∞ –¥–æ –∫–æ–Ω—Ü–∞.

### –°–∏–≥–Ω–∞—Ç—É—Ä–∞

```typescript
export function simulateOrder(
  order: Order,               // –î–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞
  params: SimulationParams    // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏–º—É–ª—è—Ü–∏–∏
): SimulationResult
```

### –í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (SimulationParams)

```typescript
{
  hoursPerDay: 8,                        // –ß–∞—Å–æ–≤ –≤ —Ä–∞–±–æ—á–µ–º –¥–Ω–µ
  physicalWorkers: 5,                    // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤
  breakMinutesPerHour: 10,               // –ú–∏–Ω—É—Ç –ø–µ—Ä–µ—Ä—ã–≤–∞ –≤ —á–∞—Å
  varianceMode: "NONE",                  // –†–µ–∂–∏–º –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏
  productivityAlgorithm: "BOTTLENECK"    // –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
}
```

### –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (SimulationResult)

```typescript
{
  log: string;                           // –¢–µ–∫—Å—Ç–æ–≤—ã–π –ª–æ–≥ —Å–∏–º—É–ª—è—Ü–∏–∏
  operationBreakdown: OperationCostBreakdown[];  // –†–∞–∑–±–∏–≤–∫–∞ –∑–∞—Ç—Ä–∞—Ç –ø–æ –æ–ø–µ—Ä–∞—Ü–∏—è–º
  totalCosts: {                          // –ò—Ç–æ–≥–æ–≤—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã
    materials: 1500.00,                  // –°—Ç–æ–∏–º–æ—Å—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
    equipment: 800.00,                   // –ê–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
    labor: 2000.00,                      // –û–ø–ª–∞—Ç–∞ —Ç—Ä—É–¥–∞
    total: 4300.00                       // –ò—Ç–æ–≥–æ
  }
}
```

### –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª —Å–∏–º—É–ª—è—Ü–∏–∏

```typescript
while (true) {
  absoluteHour++;  // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ —á–∞—Å–æ–≤
  
  // 1. –ü–µ—Ä–µ–¥–∞—á–∞ –¥–µ—Ç–∞–ª–µ–π –º–µ–∂–¥—É –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ (–¥–ª—è PER_UNIT)
  //    –í –Ω–∞—á–∞–ª–µ –∫–∞–∂–¥–æ–≥–æ —á–∞—Å–∞ –¥–µ—Ç–∞–ª–∏, –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–Ω—ã–µ –≤ –ø—Ä–æ—à–ª–æ–º —á–∞—Å—É,
  //    —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
  
  // 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
  //    - –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≤–µ—Ä—à–∏–ª—Å—è –ª–∏ —Ä–∞–±–æ—á–∏–π —Ü–∏–∫–ª
  //    - –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
  //    - –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∑–∞—Ç—Ä–∞—Ç—ã (–º–∞—Ç–µ—Ä–∏–∞–ª—ã, –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ, —Ç—Ä—É–¥)
  //    - –ï—Å–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ‚Üí –ø–æ–º–µ—á–∞–µ–º –∫–∞–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—É—é
  //    - –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –ø–ª–∞–Ω–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Ü–∏–∫–ª
  
  // 3. –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
  //    - –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤, —á—å–µ –≤—Ä–µ–º—è –∏—Å—Ç–µ–∫–ª–æ
  //    - –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
  
  // 4. –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø—É—Å–∫–∞ –Ω–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
  //    - –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
  //    - –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ä–µ—Å—É—Ä—Å–æ–≤
  //    - –ï—Å–ª–∏ –≤—Å–µ —É—Å–ª–æ–≤–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã ‚Üí –∑–∞–ø—É—Å–∫–∞–µ–º –æ–ø–µ—Ä–∞—Ü–∏—é
  
  // 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
  //    –ï—Å–ª–∏ –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω—ã ‚Üí –≤—ã—Ö–æ–¥–∏–º –∏–∑ —Ü–∏–∫–ª–∞
  
  // 6. –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–≤–∏—Å–∞–Ω–∏—è
  //    –ï—Å–ª–∏ –Ω–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ 100 —á–∞—Å–æ–≤ ‚Üí –ø—Ä–µ—Ä—ã–≤–∞–µ–º —Å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π
}
```

---

## –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### releaseResources()

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã (—Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ), —á—å–µ –≤—Ä–µ–º—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏—Å—Ç–µ–∫–ª–æ.

**–õ–æ–≥–∏–∫–∞:**
```typescript
function releaseResources(resources, currentHour, log) {
  // 1. –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –≤—Å–µ–º –∑–∞–Ω—è—Ç—ã–º —Ä–∞–±–æ—Ç–Ω–∏–∫–∞–º
  resources.busyWorkers.forEach((info, workerId) => {
    if (info.untilHour <= currentHour) {
      // –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∏—Å—Ç–µ–∫–ª–æ ‚Üí –æ—Å–≤–æ–±–æ–∂–¥–∞–µ–º
      resources.busyWorkers.delete(workerId);
      log.push(`‚úÖ –û—Å–≤–æ–±–æ–¥–∏–ª—Å—è —Ä–∞–±–æ—Ç–Ω–∏–∫ #${workerId}`);
    }
  });
  
  // 2. –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –≤—Å–µ–º—É –∑–∞–Ω—è—Ç–æ–º—É –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—é
  resources.busyEquipment.forEach((info, equipmentId) => {
    if (info.untilHour <= currentHour) {
      // –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∏—Å—Ç–µ–∫–ª–æ ‚Üí –æ—Å–≤–æ–±–æ–∂–¥–∞–µ–º
      resources.busyEquipment.delete(equipmentId);
      log.push(`‚úÖ –û—Å–≤–æ–±–æ–¥–∏–ª–æ—Å—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ "${info.equipmentName}"`);
    }
  });
}
```

---

### processActiveOperations()

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ —Ç–µ–∫—É—â–µ–º —á–∞—Å—É.

**–û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏:**

#### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ü–∏–∫–ª–∞

```typescript
const cycleEnd = opState.cycleStartHour + opState.operationDuration;

if (cycleEnd === currentHour) {
  // –¶–∏–∫–ª –∑–∞–≤–µ—Ä—à–∏–ª—Å—è ‚Üí —Å—á–∏—Ç–∞–µ–º –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
}
```

#### 2. –†–∞—Å—á–µ—Ç –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞

**–î–ª—è ONE_TIME (—Ä–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π):**
```typescript
// –í–µ—Å—å —Ç–∏—Ä–∞–∂ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞ –æ–¥–∏–Ω —Ä–∞–∑
producedThisCycle = totalQuantity - completedQuantity;
```

**–î–ª—è PER_UNIT (–ø–æ—Ç–æ—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π):**

```typescript
// –®–∞–≥ 1: –†–∞—Å—á–µ—Ç –±–∞–∑–æ–≤–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
let baseProductivity = applyVariance(
  operation.estimatedProductivityPerHour,
  operation.estimatedProductivityPerHourVariance,
  varianceMode
);

// –®–∞–≥ 2: –†–∞—Å—á–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
let equipmentProductivity = Infinity;
if (–µ—Å—Ç—å_–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ_—Å_–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é) {
  equipmentProductivity = MIN(–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å_–≤—Å–µ–≥–æ_–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è);
}

// –®–∞–≥ 3: –†–∞—Å—á–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤
let roleProductivity = Infinity;
if (–µ—Å—Ç—å_—Ä–æ–ª–∏_—Å_–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é) {
  if (—Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ >= –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Ä–æ–ª–µ–π) {
    // –ö–∞–∂–¥–æ–π —Ä–æ–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª—é–¥–µ–π
    roleProductivity = MIN(–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å_–≤—Å–µ—Ö_—Ä–æ–ª–µ–π);
  } else {
    // –†–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –º–µ–Ω—å—à–µ, —á–µ–º —Ä–æ–ª–µ–π ‚Üí —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º
    roleProductivity = 1 / SUM(1 / –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å_–∫–∞–∂–¥–æ–π_—Ä–æ–ª–∏);
  }
}

// –®–∞–≥ 4: –í—ã–±–æ—Ä –∏—Ç–æ–≥–æ–≤–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
if (productivityAlgorithm === "NOMINAL") {
  realProductivity = baseProductivity;  // –¢–æ–ª—å–∫–æ –Ω–æ–º–∏–Ω–∞–ª—å–Ω–∞—è
} else {
  realProductivity = MIN(baseProductivity, equipmentProductivity, roleProductivity);  // –ë—É—Ç—ã–ª–æ—á–Ω–æ–µ –≥–æ—Ä–ª—ã—à–∫–æ
}

// –®–∞–≥ 5: –£—á–µ—Ç –ø–µ—Ä–µ—Ä—ã–≤–æ–≤
realProductivity *= breakCoefficient;  // breakCoefficient = 1 - (breakMinutes / 60)

// –®–∞–≥ 6: –†–∞—Å—á–µ—Ç –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
const exactProduction = realProductivity * cycleHours;

// –í–ê–ñ–ù–û: –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö —Ü–∏–∫–ª–æ–≤ (< 1 —á–∞—Å) –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ —Å —É—á–µ—Ç–æ–º –ø–æ—Ä–æ–≥–∞ 0.5
producedThisCycle = exactProduction >= 0.5 
  ? Math.max(1, Math.floor(exactProduction)) 
  : Math.floor(exactProduction);

// –®–∞–≥ 7: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é –¥–µ—Ç–∞–ª–µ–π (–¥–ª—è –∑–∞–≤–∏—Å–∏–º—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π)
if (!isFirstInChain && chainType === "PER_UNIT") {
  const availableFromPrevious = previousOperation.transferredQuantity - completedQuantity;
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ø–∞—Ä—Ç–∏–∏
  if (operation.minimumBatchSize && availableFromPrevious < operation.minimumBatchSize) {
    producedThisCycle = 0;  // –ñ–¥–µ–º –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ø–∞—Ä—Ç–∏–∏
    log.push("‚è∏Ô∏è –û–∂–∏–¥–∞–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ø–∞—Ä—Ç–∏–∏");
  } else {
    producedThisCycle = MIN(producedThisCycle, availableFromPrevious);
  }
}
```

#### 3. –†–∞—Å—á–µ—Ç –∑–∞—Ç—Ä–∞—Ç

**–ú–∞—Ç–µ—Ä–∏–∞–ª—ã:**
```typescript
enabledMaterials.forEach(mat => {
  // –ü—Ä–∏–º–µ–Ω—è–µ–º variance –∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –º–∞—Ç–µ—Ä–∏–∞–ª–∞
  const adjustedQuantity = applyVariance(mat.quantity, mat.variance, varianceMode, false);
  
  // –†–∞—Å—Ö–æ–¥ = —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ_–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ √ó –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–æ_–¥–µ—Ç–∞–ª–µ–π
  const quantityUsed = adjustedQuantity * producedThisCycle;
  
  // –°—Ç–æ–∏–º–æ—Å—Ç—å = —Ä–∞—Å—Ö–æ–¥ √ó —Ü–µ–Ω–∞_–∑–∞_–µ–¥–∏–Ω–∏—Ü—É
  const cost = mat.unitPrice * quantityUsed;
  
  // –ù–î–°
  const vatAmount = cost * (mat.material.vatPercentage / 100);
  
  totalMaterialCost += cost;
  totalMaterialVAT += vatAmount;
});
```

**–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ:**
```typescript
enabledEquipment.forEach(eq => {
  // –ü—Ä–∏–º–µ–Ω—è–µ–º variance –∫ —á–∞—Å–æ–≤–æ–π —Å—Ç–∞–≤–∫–µ –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏–∏
  const adjustedHourlyRate = applyVariance(eq.hourlyRate, eq.variance, varianceMode, false);
  
  // –°—Ç–æ–∏–º–æ—Å—Ç—å = —Å—Ç–∞–≤–∫–∞ √ó –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å_–æ–ø–µ—Ä–∞—Ü–∏–∏
  const cost = adjustedHourlyRate * operationDuration;
  
  totalEquipmentCost += cost;
});
```

**–¢—Ä—É–¥:**
```typescript
enabledRoles.forEach(role => {
  // –ü—Ä–∏–º–µ–Ω—è–µ–º variance –∫ —Å—Ç–∞–≤–∫–µ
  const adjustedRate = applyVariance(role.rate, role.variance, varianceMode, false);
  
  let cost = 0;
  
  if (role.requiresContinuousPresence) {
    // –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ ‚Üí –æ–ø–ª–∞—á–∏–≤–∞–µ–º –∑–∞ –≤—Å—é –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
    cost = adjustedRate * operationDuration;
    
  } else if (role.piecesPerHour > 0) {
    // –û–ø–ª–∞—Ç–∞ –ø–æ –¥–µ—Ç–∞–ª—è–º
    const costPerPiece = adjustedRate / role.piecesPerHour;
    cost = costPerPiece * producedThisCycle;
    
  } else {
    // –û–ø–ª–∞—Ç–∞ —Ç–æ–ª—å–∫–æ –∑–∞ –≤—Ä–µ–º—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    cost = adjustedRate * role.timeSpent;
  }
  
  totalLaborCost += cost;
});
```

#### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏

```typescript
let isOperationComplete = false;

if (chainType === "PER_UNIT" && !isFirstInChain) {
  // –î–ª—è –∑–∞–≤–∏—Å–∏–º—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π: –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –∫–æ–≥–¥–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –í–°–ï –¥–µ—Ç–∞–ª–∏ –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–π
  const prevOpCompleted = completedOperations.has(previousOperationKey);
  
  if (prevOpCompleted && completedQuantity >= totalQuantity) {
    isOperationComplete = true;
  }
} else {
  // –î–ª—è –ø–µ—Ä–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏–ª–∏ ONE_TIME: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
  if (completedQuantity >= totalQuantity) {
    isOperationComplete = true;
  }
}

if (isOperationComplete) {
  // –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—É—é
  completedOperations.add(operationKey);
  
  // –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º –≤—Å–µ —Ä–µ—Å—É—Ä—Å—ã
  releaseAllResources(opState, resources);
  
} else {
  // –ü–ª–∞–Ω–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Ü–∏–∫–ª
  opState.cycleStartHour = currentHour;
  opState.operationDuration = recalculateDuration();
  
  // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
  updateContinuousResources(opState, resources, currentHour);
}
```

---

### tryStartNewOperations()

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—ã—Ç–∞–µ—Ç—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –µ—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –≤—Å–µ —É—Å–ª–æ–≤–∏—è.

**–õ–æ–≥–∏–∫–∞:**

```typescript
function tryStartNewOperations(order, activeOperations, completedOperations, resources, currentHour) {
  for (const item of order.orderItems) {
    const process = item.productionProcess;
    
    // –†–∞–∑–¥–µ–ª—è–µ–º —Ü–µ–ø–æ—á–∫–∏ –ø–æ —Ç–∏–ø–∞–º
    const oneTimeChains = process.operationChains.filter(c => c.chainType === "ONE_TIME");
    const perUnitChains = process.operationChains.filter(c => c.chainType === "PER_UNIT");
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≤–µ—Ä—à–µ–Ω—ã –ª–∏ –≤—Å–µ ONE_TIME —Ü–µ–ø–æ—á–∫–∏
    const oneTimeCompleted = allOneTimeOperationsCompleted(oneTimeChains);
    
    if (!oneTimeCompleted) {
      // –°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω—è–µ–º ONE_TIME –æ–ø–µ—Ä–∞—Ü–∏–∏ (–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞)
      oneTimeChains.forEach(chain => {
        tryStartChainOperation(chain, ...);
      });
    } else {
      // –ü–æ—Å–ª–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ–º PER_UNIT –æ–ø–µ—Ä–∞—Ü–∏–∏ (–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ)
      perUnitChains.forEach(chain => {
        tryStartChainOperation(chain, ...);
      });
    }
  }
}
```

---

### tryStartChainOperation()

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—ã—Ç–∞–µ—Ç—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é –≤ —Ü–µ–ø–æ—á–∫–µ.

**–ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º:**

#### 1. –û–ø–µ—Ä–∞—Ü–∏—è —É–∂–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞?
```typescript
if (completedOperations.has(operationKey)) {
  log.push("‚úÖ –û–ø–µ—Ä–∞—Ü–∏—è —É–∂–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º...");
  continue;  // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
}
```

#### 2. –û–ø–µ—Ä–∞—Ü–∏—è —É–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è?
```typescript
const existingActiveOp = activeOperations.find(op => op.operation.id === operation.id);
if (existingActiveOp && hasAllocatedResources) {
  log.push("‚è© –û–ø–µ—Ä–∞—Ü–∏—è —É–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º...");
  continue;
}
```

#### 3. –ü—Ä–µ–¥—ã–¥—É—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≥–æ—Ç–æ–≤—ã?

**–î–ª—è ONE_TIME:**
```typescript
// –í—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ó–ê–í–ï–†–®–ï–ù–´
const prevOpsCompleted = previousOperations.every(op => 
  completedOperations.has(operationKey)
);

if (!prevOpsCompleted) {
  log.push("‚è∏Ô∏è –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π...");
  continue;
}
```

**–î–ª—è PER_UNIT:**
```typescript
// –ü—Ä–µ–¥—ã–¥—É—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω—ã –ò –ø–µ—Ä–µ–¥–∞—Ç—å —Ö–æ—Ç—è –±—ã 1 –¥–µ—Ç–∞–ª—å
const prevOpsReady = previousOperations.every(op => {
  // –ó–∞–≤–µ—Ä—à–µ–Ω–∞?
  if (completedOperations.has(operationKey)) return true;
  
  // –ê–∫—Ç–∏–≤–Ω–∞ –∏ –ø–µ—Ä–µ–¥–∞–ª–∞ —Ö–æ—Ç—è –±—ã 1 –¥–µ—Ç–∞–ª—å?
  const activeOp = findActiveOperation(op);
  return activeOp && activeOp.transferredQuantity > 0;
});

if (!prevOpsReady) {
  log.push("‚è∏Ô∏è –û–∂–∏–¥–∞–Ω–∏–µ –¥–µ—Ç–∞–ª–µ–π –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–π –æ–ø–µ—Ä–∞—Ü–∏–∏...");
  continue;
}
```

#### 4. –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ —Å–≤–æ–±–æ–¥–Ω–æ?
```typescript
const enabledEquipment = operation.operationEquipment.filter(e => e.enabled);

for (const equipment of enabledEquipment) {
  if (resources.busyEquipment.has(equipment.id)) {
    const busyInfo = resources.busyEquipment.get(equipment.id);
    log.push(`‚è∏Ô∏è –û–∂–∏–¥–∞–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è "${equipment.name}" (–∑–∞–Ω—è—Ç–æ –¥–æ —á–∞—Å–∞ ${busyInfo.untilHour})`);
    canStart = false;
    break;
  }
}

if (!canStart) continue;
```

#### 5. –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤?
```typescript
const enabledRoles = operation.operationRoles.filter(r => r.enabled);
const availableWorkers = resources.physicalWorkers - resources.busyWorkers.size;

if (enabledRoles.length > availableWorkers) {
  log.push(`‚è∏Ô∏è –ù–µ —Ö–≤–∞—Ç–∞–µ—Ç —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ (—Ç—Ä–µ–±—É–µ—Ç—Å—è: ${enabledRoles.length}, —Å–≤–æ–±–æ–¥–Ω–æ: ${availableWorkers})`);
  continue;
}
```

#### 6. –ó–∞–ø—É—Å–∫ –æ–ø–µ—Ä–∞—Ü–∏–∏

```typescript
// –í—ã–¥–µ–ª—è–µ–º —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤
const assignedWorkerIds = [];
for (let i = 0; i < enabledRoles.length; i++) {
  const workerId = findFreeWorker(resources);
  assignedWorkerIds.push(workerId);
  
  resources.busyWorkers.set(workerId, {
    operationName: operation.name,
    productName: item.product.name,
    untilHour: currentHour + operationDuration
  });
}

// –í—ã–¥–µ–ª—è–µ–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
const assignedEquipmentIds = [];
enabledEquipment.forEach(eq => {
  assignedEquipmentIds.push(eq.id);
  
  resources.busyEquipment.set(eq.id, {
    equipmentName: eq.equipment.name,
    operationName: operation.name,
    productName: item.product.name,
    untilHour: currentHour + operationDuration
  });
});

// –°–æ–∑–¥–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é
const activeOp = {
  itemId: item.id,
  productName: item.product.name,
  chainId: chain.id,
  chainName: chain.name,
  chainType: chain.chainType,
  operation: operation,
  totalQuantity: totalQuantity,
  completedQuantity: 0,
  transferredQuantity: 0,
  pendingTransferQuantity: 0,
  cycleStartHour: currentHour,
  operationDuration: operationDuration,
  assignedWorkerIds: assignedWorkerIds,
  assignedEquipmentIds: assignedEquipmentIds,
  continuousWorkerIds: new Set(–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–µ_—Ä–∞–±–æ—Ç–Ω–∏–∫–∏),
  continuousEquipmentIds: new Set(–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ_–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ),
  initialDuration: operationDuration,
  isFirstInChain: isFirstOperation,
  previousOperationId: previousOperation?.id
};

activeOperations.push(activeOp);

log.push("üöÄ –ù–ê–ß–ê–õ–û –û–ü–ï–†–ê–¶–ò–ò: \"" + operation.name + "\"");
log.push("     –¢–æ–≤–∞—Ä: " + item.product.name);
log.push("     –¶–µ–ø–æ—á–∫–∞: " + chain.name);
log.push("     –¢–∏—Ä–∞–∂: " + totalQuantity + " —à—Ç.");
```

---

## –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è

### 1. –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É ONE_TIME –∏ PER_UNIT

**ONE_TIME (—Ä–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏):**
- –í—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –¥–ª—è –≤—Å–µ–≥–æ —Ç–∏—Ä–∞–∂–∞
- –°–ª–µ–¥—É—é—â–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ü–û–õ–ù–û–ì–û –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–π
- –ü—Ä–∏–º–µ—Ä: –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–æ—Ä–º—ã

**PER_UNIT (–ø–æ—Ç–æ—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏):**
- –í—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Ü–∏–∫–ª–∞–º–∏, –ø—Ä–æ–∏–∑–≤–æ–¥—è –¥–µ—Ç–∞–ª–∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ
- –°–ª–µ–¥—É—é—â–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –º–æ–∂–µ—Ç –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –ø–æ—è–≤–∏–ª–∞—Å—å –ü–ï–†–í–ê–Ø –¥–µ—Ç–∞–ª—å –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–π
- –ü—Ä–∏–º–µ—Ä: –ª–∏—Ç—å–µ, –∑–∞—á–∏—Å—Ç–∫–∞, –≥–∞–ª—Ç–æ–≤–∫–∞

### 2. –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–µ—Ç–∞–ª–µ–π (–¥–ª—è PER_UNIT)

```typescript
// –í –∫–æ–Ω—Ü–µ —Ü–∏–∫–ª–∞:
opState.pendingTransferQuantity = opState.completedQuantity;

// –í –Ω–∞—á–∞–ª–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —á–∞—Å–∞:
opState.transferredQuantity = opState.pendingTransferQuantity;
```

–≠—Ç–æ –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç –∑–∞–¥–µ—Ä–∂–∫—É –≤ 1 —á–∞—Å –º–µ–∂–¥—É –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ–º –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π –æ–ø–µ—Ä–∞—Ü–∏–∏.

### 3. –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø–∞—Ä—Ç–∏—è (minimumBatchSize)

–ï—Å–ª–∏ —É –æ–ø–µ—Ä–∞—Ü–∏–∏ —É–∫–∞–∑–∞–Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø–∞—Ä—Ç–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, 100 —à—Ç), —Ç–æ –æ–ø–µ—Ä–∞—Ü–∏—è:
1. –ñ–¥–µ—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–µ—Ç–∞–ª–µ–π
2. –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã –Ω–∞ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è
3. –í–æ–∑–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø–∞—Ä—Ç–∏—è –Ω–∞–∫–æ–ø–ª–µ–Ω–∞

### 4. –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ—Å—É—Ä—Å—ã —Ç—Ä–µ–±—É—é—Ç –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã:
- `requiresContinuousPresence` (–¥–ª—è —Ä–æ–ª–µ–π)
- `requiresContinuousOperation` (–¥–ª—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è)

–¢–∞–∫–∏–µ —Ä–µ—Å—É—Ä—Å—ã –æ—Å—Ç–∞—é—Ç—Å—è –∑–∞–Ω—è—Ç—ã–º–∏ –º–µ–∂–¥—É —Ü–∏–∫–ª–∞–º–∏ –∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã.

### 5. –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–≤–∏—Å–∞–Ω–∏—è

–ï—Å–ª–∏ —Å–∏–º—É–ª—è—Ü–∏—è –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ 100 —á–∞—Å–æ–≤ –ø–æ–¥—Ä—è–¥:
1. –ü—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
2. –í—ã–≤–æ–¥–∏—Ç—Å—è –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:
   - –ö–∞–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∂–¥—É—Ç
   - –ü—Ä–∏—á–∏–Ω—ã –æ–∂–∏–¥–∞–Ω–∏—è (–Ω–µ—Ç —Ä–µ—Å—É—Ä—Å–æ–≤, –∂–¥—É—Ç –¥–µ—Ç–∞–ª–µ–π –∏ —Ç.–¥.)

---

## –ß–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏–µ—Å—è –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –û–ø–µ—Ä–∞—Ü–∏—è –Ω–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. ‚ùå –ü—Ä–µ–¥—ã–¥—É—â–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ (ONE_TIME) –∏–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–ª–∞ –¥–µ—Ç–∞–ª–∏ (PER_UNIT)
2. ‚ùå –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–æ
3. ‚ùå –ù–µ —Ö–≤–∞—Ç–∞–µ—Ç —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤
4. ‚ùå –ñ–¥–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –ø–∞—Ä—Ç–∏—é

**–†–µ—à–µ–Ω–∏–µ:** –°–º–æ—Ç—Ä–∏—Ç–µ –≤ –ª–æ–≥ —Å–µ–∫—Ü–∏—é "‚è∏Ô∏è –û–∂–∏–¥–∞—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏"

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ù–∏–∑–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. ‚ùå –†–µ–∂–∏–º –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ MIN –∏–ª–∏ MIN_PRODUCTIVITY_MAX_COSTS
2. ‚ùå –ê–ª–≥–æ—Ä–∏—Ç–º BOTTLENECK –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –º–µ–¥–ª–µ–Ω–Ω—ã–º —Ä–µ—Å—É—Ä—Å–æ–º
3. ‚ùå –ë–æ–ª—å—à–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç —Ä–∞–∑–±—Ä–æ—Å–∞ (variance)
4. ‚ùå –ú–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –ø–µ—Ä–µ—Ä—ã–≤—ã (breakMinutesPerHour)

**–†–µ—à–µ–Ω–∏–µ:** 
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏–º—É–ª—è—Ü–∏–∏
- –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –ª–æ–≥ —Å–µ–∫—Ü–∏—é —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –û–ø–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç 0 –¥–µ—Ç–∞–ª–µ–π –≤ —Ü–∏–∫–ª–µ

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. ‚ùå –û–∂–∏–¥–∞–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ø–∞—Ä—Ç–∏–∏
2. ‚ùå –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–µ—Ç–∞–ª–µ–π –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
3. ‚ùå –û—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–π —Ü–∏–∫–ª + –Ω–∏–∑–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (< 0.5 –¥–µ—Ç–∞–ª–∏ –∑–∞ —Ü–∏–∫–ª)

**–†–µ—à–µ–Ω–∏–µ:**
- –£–≤–µ–ª–∏—á—å—Ç–µ cycleHours
- –£–≤–µ–ª–∏—á—å—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ minimumBatchSize

---

## –ö–∞–∫ —á–∏—Ç–∞—Ç—å –ª–æ–≥ —Å–∏–º—É–ª—è—Ü–∏–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥–∞

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë   –°–ò–ú–£–õ–Ø–¶–ò–Ø –í–´–ü–û–õ–ù–ï–ù–ò–Ø –ó–ê–ö–ê–ó–ê         ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

üìã –ó–∞–∫–∞–∑: –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞

‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏–º—É–ª—è—Ü–∏–∏:
   ‚Ä¢ –ß–∞—Å–æ–≤ –≤ —Ä–∞–±–æ—á–µ–º –¥–Ω–µ: 8
   ‚Ä¢ –§–∏–∑–∏—á–µ—Å–∫–∏—Ö —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤: 5
   ‚Ä¢ –û—Ç–¥—ã—Ö (–º–∏–Ω/—á–∞—Å): 10
   ‚Ä¢ –†–µ–∂–∏–º —Ä–∞–∑–±—Ä–æ—Å–∞: –ü–æ –Ω–æ–º–∏–Ω–∞–ª—É
   ‚Ä¢ –ê–ª–≥–æ—Ä–∏—Ç–º: –ë—É—Ç—ã–ª–æ—á–Ω–æ–µ –≥–æ—Ä–ª—ã—à–∫–æ

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
  üìÖ –î–ï–ù–¨ 1
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

‚è∞ –ß–∞—Å 1 (–∞–±—Å–æ–ª—é—Ç–Ω—ã–π —á–∞—Å: 1)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

  üöÄ –ù–ê–ß–ê–õ–û –û–ü–ï–†–ê–¶–ò–ò: "–ª–∏—Ç—å–µ"
     –¢–æ–≤–∞—Ä: –ó–∞–≥–æ—Ç–æ–≤–∫–∞
     –¶–µ–ø–æ—á–∫–∞: –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ (–ø–æ—Ç–æ—á–Ω–∞—è)
     –¢–∏—Ä–∞–∂: 1600 —à—Ç.

  üìä –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏–π: 1
     ‚Ä¢ "–ª–∏—Ç—å–µ" (–ó–∞–≥–æ—Ç–æ–≤–∫–∞)
       –î–µ—Ç–∞–ª–µ–π –≤ —Ä–∞–±–æ—Ç–µ: 0 —à—Ç.
       –î–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ü–∏–∫–ª–∞: 1 —á–∞—Å(–æ–≤)
       –ó–∞–Ω—è—Ç–æ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤: #1, #2
       –ó–∞–Ω—è—Ç–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è: –õ–∏—Ç–µ–π–Ω–∞—è –º–∞—à–∏–Ω–∞

‚è∞ –ß–∞—Å 2 (–∞–±—Å–æ–ª—é—Ç–Ω—ã–π —á–∞—Å: 2)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

  üîß –û–ø–µ—Ä–∞—Ü–∏—è: "–ª–∏—Ç—å–µ"
     –¢–æ–≤–∞—Ä: –ó–∞–≥–æ—Ç–æ–≤–∫–∞
     –¶–µ–ø–æ—á–∫–∞: –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ (–ø–æ—Ç–æ—á–Ω–∞—è)
     –ù–æ–º–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 1600.00 —à—Ç/—á–∞—Å
     –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—é: 1600.00 —à—Ç/—á–∞—Å
     –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ —Ä–∞–±–æ—Ç–Ω–∏–∫–∞–º: 1600.00 —à—Ç/—á–∞—Å
     ‚öôÔ∏è –ê–ª–≥–æ—Ä–∏—Ç–º: –ë—É—Ç—ã–ª–æ—á–Ω–æ–µ –≥–æ—Ä–ª—ã—à–∫–æ
     –ò—Ç–æ–≥–æ–≤–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 1600.00 —à—Ç/—á–∞—Å
     –†–µ–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—Å —É—á–µ—Ç–æ–º –æ—Ç–¥—ã—Ö–∞): 1466.67 —à—Ç/—á–∞—Å
     üî¢ –ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–æ –≤ —ç—Ç–æ–º —Ü–∏–∫–ª–µ: 1466 —à—Ç.
     ‚úîÔ∏è –í—ã–ø–æ–ª–Ω–µ–Ω–æ: 1466 —à—Ç. (–≤—Å–µ–≥–æ: 1466/1600)
     üíé –ú–∞—Ç–µ—Ä–∏–∞–ª "–ú–µ—Ç–∞–ª–ª": 1466.00 –∫–≥ √ó 10.00 = 14660.00 —Ä—É–±.
     üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: 14660.00 —Ä—É–±.
     ‚öôÔ∏è –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ "–õ–∏—Ç–µ–π–Ω–∞—è –º–∞—à–∏–Ω–∞": 1.00 —á–∞—Å √ó 500.00 = 500.00 —Ä—É–±.
     üí∞ –ê–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è: 500.00 —Ä—É–±.
     üë§ –†–æ–ª—å "–õ–∏—Ç–µ–π—â–∏–∫": 500.00 —Ä—É–±
     üí∞ –û–ø–ª–∞—Ç–∞ —Ç—Ä—É–¥–∞: 500.00 —Ä—É–±.
     üîÑ –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ü–∏–∫–ª–µ...
```

### –ö–ª—é—á–µ–≤—ã–µ —Å–µ–∫—Ü–∏–∏

1. **üöÄ –ù–ê–ß–ê–õ–û –û–ü–ï–†–ê–¶–ò–ò** - –æ–ø–µ—Ä–∞—Ü–∏—è –∑–∞–ø—É—Å—Ç–∏–ª–∞—Å—å
2. **üîß –û–ø–µ—Ä–∞—Ü–∏—è** - –æ–ø–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–∏–ª–∞ —Ü–∏–∫–ª –∏ –ø—Ä–æ–∏–∑–≤–µ–ª–∞ –¥–µ—Ç–∞–ª–∏
3. **‚è∏Ô∏è –û–∂–∏–¥–∞—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** - –æ–ø–µ—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–æ–≥—É—Ç –Ω–∞—á–∞—Ç—å—Å—è (—Å –ø—Ä–∏—á–∏–Ω–∞–º–∏)
4. **‚úÖ –û—Å–≤–æ–±–æ–¥–∏–ª—Å—è...** - —Ä–µ—Å—É—Ä—Å –æ—Å–≤–æ–±–æ–¥–∏–ª—Å—è
5. **üìä –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏–π** - —Å—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠—Ç–æ—Ç —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã —Ä–∞–±–æ—Ç—ã —Å–∏–º—É–ª—è—Ü–∏–∏. –î–ª—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∏–∑—É—á–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

1. –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª `/home/ubuntu/production_cost_system/app/lib/simulation-engine.ts`
2. –ß–∏—Ç–∞—Ç—å –∫–æ–¥ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É—è —ç—Ç–æ—Ç —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–∞–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏—é
3. –ó–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–∏–º—É–ª—è—Ü–∏–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
4. –ò–∑—É—á–∞—Ç—å –ª–æ–≥–∏ —Å–∏–º—É–ª—è—Ü–∏–∏ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞

