
# üíæ –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

## –û–±–∑–æ—Ä

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –∑–∞—â–∏—Ç—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã** –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
2. **–†—É—á–Ω—ã–µ –±—ç–∫–∞–ø—ã** –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é
3. **–ü—Ä–æ—Å—Ç–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** –∏–∑ –ª—é–±–æ–≥–æ –±—ç–∫–∞–ø–∞
4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞** —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤ (—Ö—Ä–∞–Ω—è—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30)

## üìã –ö–æ–º–∞–Ω–¥—ã

### –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞

```bash
# –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø –≤—Ä—É—á–Ω—É—é
node scripts/auto-backup.js create manual

# –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π
node scripts/auto-backup.js create before_migration

# –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø –ø–æ—Å–ª–µ –≤–∞–∂–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
node scripts/auto-backup.js create after_data_entry
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –±—ç–∫–∞–ø–æ–≤

```bash
# –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –±—ç–∫–∞–ø–æ–≤
node scripts/auto-backup.js list
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```bash
# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ (—Å –≤—ã–±–æ—Ä–æ–º –±—ç–∫–∞–ø–∞)
node scripts/restore-backup.js

# –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –±—ç–∫–∞–ø–æ–≤ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
node scripts/restore-backup.js list
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –±—ç–∫–∞–ø–æ–º
node scripts/migrate-with-backup.js
```

## üîÑ –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å

### –ü–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Å—Ö–µ–º—ã –ë–î:

```bash
# 1. –°–æ–∑–¥–∞–π—Ç–µ –±—ç–∫–∞–ø
node scripts/auto-backup.js create before_schema_change

# 2. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –±–µ–∑–æ–ø–∞—Å–Ω–æ
node scripts/migrate-with-backup.js

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ
yarn dev
```

### –ü–æ—Å–ª–µ –≤–∞–∂–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö:

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –±—ç–∫–∞–ø –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏
node scripts/auto-backup.js create after_data_entry
```

### –ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö:

```bash
# 1. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –±—ç–∫–∞–ø–æ–≤
node scripts/restore-backup.js list

# 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–∑ –Ω—É–∂–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞
node scripts/restore-backup.js

# 3. –í—ã–±–µ—Ä–∏—Ç–µ –±—ç–∫–∞–ø –∏–∑ —Å–ø–∏—Å–∫–∞
# 4. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ë—ç–∫–∞–ø—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ** –≤ `scripts/backups/`
2. **–ú–∞–∫—Å–∏–º—É–º 30 –±—ç–∫–∞–ø–æ–≤** - —Å—Ç–∞—Ä—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è
3. **–ü–µ—Ä–µ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º** —Å–æ–∑–¥–∞—ë—Ç—Å—è –±—ç–∫–∞–ø —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `migrate-with-backup.js`** –≤–º–µ—Å—Ç–æ `prisma migrate deploy`

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±—ç–∫–∞–ø–æ–≤

```
scripts/backups/
‚îú‚îÄ‚îÄ backup_before_migration_2025-10-02T22-30-00-000Z.sql
‚îú‚îÄ‚îÄ backup_manual_2025-10-02T22-35-00-000Z.sql
‚îú‚îÄ‚îÄ backup_after_data_entry_2025-10-02T22-40-00-000Z.sql
‚îî‚îÄ‚îÄ ...
```

## üéì –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏

```bash
# –®–∞–≥ 1: –ë—ç–∫–∞–ø –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã
node scripts/auto-backup.js create before_feature

# –®–∞–≥ 2: –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ö–µ–º—ã
nano prisma/schema.prisma

# –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏
yarn prisma migrate dev --name add_new_feature

# –®–∞–≥ 4: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å –±—ç–∫–∞–ø–æ–º
node scripts/migrate-with-backup.js
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏

```bash
# –ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫...
# –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ

node scripts/restore-backup.js
# –í—ã–±–∏—Ä–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–±–æ—á–∏–π –±—ç–∫–∞–ø
# –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –†–µ–≥—É–ª—è—Ä–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

```bash
# –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –∏–ª–∏ –ø–æ—Å–ª–µ –≤–∞–∂–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
node scripts/auto-backup.js create daily_backup
```

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –±—ç–∫–∞–ø** –ø–µ—Ä–µ–¥ –ª—é–±—ã–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Å—Ö–µ–º—ã –ë–î
2. **–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –±—ç–∫–∞–ø** –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ –±–æ–ª—å—à–æ–≥–æ –æ–±—ä—ë–º–∞ –¥–∞–Ω–Ω—ã—Ö
3. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –±—ç–∫–∞–ø—ã** –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞** –¥–ª—è —Ä—É—á–Ω—ã—Ö –±—ç–∫–∞–ø–æ–≤
5. **–•—Ä–∞–Ω–∏—Ç–µ –≤–∞–∂–Ω—ã–µ –±—ç–∫–∞–ø—ã** –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –º–µ—Å—Ç–µ

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–í —Ñ–∞–π–ª–µ `scripts/auto-backup.js`:

```javascript
const MAX_BACKUPS = 30; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ö—Ä–∞–Ω–∏–º—ã—Ö –±—ç–∫–∞–ø–æ–≤
```

## üìû –ü–æ–º–æ—â—å

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ `DATABASE_URL` –≤ `.env`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `pg_dump` –∏ `psql` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `scripts/backups/`
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏
